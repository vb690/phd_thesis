\begin{figure}[ht]
\begin{center}
\begin{adjustbox}{width=0.7\textwidth}


\tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        

\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
%uncomment if require: \path (0,359); %set diagram left start at 0, and has height of 359

%Shape: Diamond [id:dp9716226680975282] 
\draw  [fill={rgb, 255:red, 245; green, 166; blue, 35 }  ,fill opacity=0.25 ] (245.6,153.01) -- (261.77,170.53) -- (245.6,188.05) -- (229.43,170.53) -- cycle ;
%Shape: Diamond [id:dp8853919017185783] 
\draw  [fill={rgb, 255:red, 245; green, 166; blue, 35 }  ,fill opacity=0.25 ] (248.05,153.88) -- (264.22,171.4) -- (248.05,188.93) -- (231.89,171.4) -- cycle ;
%Shape: Diamond [id:dp4795794552356232] 
\draw  [fill={rgb, 255:red, 245; green, 166; blue, 35 }  ,fill opacity=0.25 ] (250.51,154.76) -- (266.68,172.28) -- (250.51,189.8) -- (234.34,172.28) -- cycle ;
%Shape: Rectangle [id:dp9874370088724661] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (286.41,139.73) -- (318.92,139.73) -- (318.92,253.47) -- (286.41,253.47) -- cycle ;
%Shape: Rectangle [id:dp4226010417229218] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (288.86,142.19) -- (321.38,142.19) -- (321.38,255.93) -- (288.86,255.93) -- cycle ;
%Shape: Rectangle [id:dp4167988625262439] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (291.32,144.65) -- (323.84,144.65) -- (323.84,258.38) -- (291.32,258.38) -- cycle ;
%Shape: Diamond [id:dp526852802214344] 
\draw  [fill={rgb, 255:red, 245; green, 166; blue, 35 }  ,fill opacity=1 ] (252.97,155.64) -- (269.13,173.16) -- (252.97,190.68) -- (236.8,173.16) -- cycle ;
%Straight Lines [id:da841242335601384] 
\draw    (268.94,173.49) -- (283.65,173.1) ;
\draw [shift={(286.65,173.03)}, rotate = 178.49] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (9.82,-4.72) -- (0,0) -- (9.82,4.72) -- (6.52,0) -- cycle    ;
%Straight Lines [id:da935707728763852] 
\draw [fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=1 ]   (197.09,234.02) -- (283.13,233.94) ;
\draw [shift={(286.13,233.94)}, rotate = 179.95] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (9.82,-4.72) -- (0,0) -- (9.82,4.72) -- (6.52,0) -- cycle    ;
%Straight Lines [id:da07325714028932928] 
\draw [fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=1 ]   (318.42,208.09) -- (348.33,208.07) ;
\draw [shift={(351.33,208.07)}, rotate = 179.97] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (9.82,-4.72) -- (0,0) -- (9.82,4.72) -- (6.52,0) -- cycle    ;
%Shape: Rectangle [id:dp05496394097706769] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (179.01,208.25) -- (211.26,208.25) -- (211.26,242.77) -- (179.01,242.77) -- cycle ;
%Shape: Rectangle [id:dp6744432975118251] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (181.63,211.23) -- (213.88,211.23) -- (213.88,245.75) -- (181.63,245.75) -- cycle ;
%Shape: Rectangle [id:dp5640519535894781] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (184.27,214.29) -- (216.53,214.29) -- (216.53,248.8) -- (184.27,248.8) -- cycle ;
%Shape: Rectangle [id:dp5804479343439016] 
\draw  [fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=1 ] (186.86,217.22) -- (219.11,217.22) -- (219.11,251.74) -- (186.86,251.74) -- cycle ;
%Shape: Rectangle [id:dp25605780939532663] 
\draw  [fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=1 ] (293.77,147.11) -- (326.29,147.11) -- (326.29,260.84) -- (293.77,260.84) -- cycle ;
%Shape: Rectangle [id:dp9553517111361907] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (179.83,147.81) -- (212.08,147.81) -- (212.08,182.32) -- (179.83,182.32) -- cycle ;
%Shape: Rectangle [id:dp840653089504606] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (182.45,150.78) -- (214.7,150.78) -- (214.7,185.3) -- (182.45,185.3) -- cycle ;
%Shape: Rectangle [id:dp8689162229522714] 
\draw  [color={rgb, 255:red, 0; green, 0; blue, 0 }  ,draw opacity=0.5 ][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.5 ] (185.09,153.84) -- (217.35,153.84) -- (217.35,188.35) -- (185.09,188.35) -- cycle ;
%Shape: Rectangle [id:dp7921236352478954] 
\draw  [fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=1 ] (187.68,156.77) -- (219.93,156.77) -- (219.93,191.29) -- (187.68,191.29) -- cycle ;
%Straight Lines [id:da24691387798535536] 
\draw    (219.82,173.49) -- (236.8,173.16) ;
%Rounded Rect [id:dp2937516721589506] 
\draw  [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][fill={rgb, 255:red, 184; green, 233; blue, 134 }  ,fill opacity=1 ][line width=1.5]  (351.64,153.41) .. controls (351.64,149.9) and (354.48,147.06) .. (357.99,147.06) -- (377.05,147.06) .. controls (380.56,147.06) and (383.4,149.9) .. (383.4,153.41) -- (383.4,253.4) .. controls (383.4,256.91) and (380.56,259.76) .. (377.05,259.76) -- (357.99,259.76) .. controls (354.48,259.76) and (351.64,256.91) .. (351.64,253.4) -- cycle ;
%Curve Lines [id:da94992026579012] 
\draw [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][line width=1.5]  [dash pattern={on 5.63pt off 4.5pt}]  (351.64,153.41) .. controls (345.63,135.1) and (358.05,126.14) .. (369.6,126.51) .. controls (379.91,126.85) and (389.53,134.63) .. (384.73,149.85) ;
\draw [shift={(383.4,153.41)}, rotate = 293.32] [fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=1 ][line width=0.08]  [draw opacity=0] (12.23,-5.88) -- (0,0) -- (12.23,5.88) -- (8.12,0) -- cycle    ;
%Straight Lines [id:da8507650796303988] 
\draw [fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=1 ]   (383.92,207.59) -- (413.83,207.57) ;
\draw [shift={(416.83,207.57)}, rotate = 179.97] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (9.82,-4.72) -- (0,0) -- (9.82,4.72) -- (6.52,0) -- cycle    ;

% Text Node
\draw (202.99,234.48) node  [font=\normalsize]  {$B_{t}$};
% Text Node
\draw (367.52,208.52) node  [font=\normalsize]  {$\hat{V}$};
% Text Node
\draw (252.15,172.28) node  [font=\normalsize]  {$O_{t}$};
% Text Node
\draw (195.34,119.64) node  [font=\LARGE]  {$x_{t}$};
% Text Node
\draw (310.03,203.98) node  [font=\normalsize]  {$OB_{t}$};
% Text Node
\draw (203.81,174.03) node  [font=\normalsize]  {$O_{t}$};
% Text Node
\draw (365.34,101.33) node  [font=\LARGE]  {$h_{t}$};
% Text Node
\draw (415,155.8) node [anchor=north west][inner sep=0.75pt]   [align=left] {
\begin{equation*}
\begin{bmatrix}
z_{11} & z_{12} & \dotsc  & z_{1h}\\
z_{21} & z_{22} & \dotsc  & \vdots \\
\vdots  & \vdots  & \ddots  & \vdots \\
z_{n1} & z_{n2} & \dotsc  & z_{nh}
\end{bmatrix}
\end{equation*}};
% Text Node
\draw (490.01,120.33) node  [font=\LARGE]  {$z_{t}$};


\end{tikzpicture}

\end{adjustbox}
\end{center}
\caption[\textbf{The procedure for generating latent representations generated by an ANN}]{Orange and green shapes represent respectively embedding and LSTM layers. Embedding layers are a type of feedforward layers specifically designed for dealing with categorical inputs \cite{chollet2015keras}. Gray shapes indicate operations with no learnable parameters, such as tensor instantiation and concatenation. The orange transparent shape indicate the concatenation of a single embedding with multiple tensors. Stacked, transparent colouring indicates arrays with a sequential structure. Straight and curved arrows refer to the presence of feed-forward or recurrent information flow. The red highlight shows the portion of the model we hypothesize is inferring an approximation of attributed incentive salience. The matrix $Z_t$ represents the high dimensional representation generated by the ANN at time $t$ after all operations in the computational graphs have been performed.}
\label{fig: repr_exctracto}
\end{figure}